<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ“Š Detailed Route Analysis Report</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .report-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 0.9em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border-left: 5px solid #3498db;
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.6em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            border-top: 4px solid #3498db;
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-section {
            margin: 20px 0;
        }

        .progress-item {
            margin-bottom: 15px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .progress-bar {
            background: #e9ecef;
            height: 12px;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-success { background: linear-gradient(90deg, #27ae60, #2ecc71); }
        .progress-warning { background: linear-gradient(90deg, #f39c12, #e67e22); }
        .progress-danger { background: linear-gradient(90deg, #e74c3c, #c0392b); }

        .risk-matrix {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .risk-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .risk-high {
            border-top: 4px solid #e74c3c;
        }

        .risk-medium {
            border-top: 4px solid #f39c12;
        }

        .risk-low {
            border-top: 4px solid #27ae60;
        }

        .recommendations-list {
            list-style: none;
            padding: 0;
        }

        .recommendations-list li {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .recommendations-list li:before {
            content: "ðŸ’¡";
            margin-right: 10px;
            font-size: 1.2em;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-color: #dc3545;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-color: #ffc107;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #17a2b8;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-color: #28a745;
        }

        .table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .table th,
        .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .table th {
            background: #34495e;
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9em;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .chart-placeholder {
            background: white;
            height: 300px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .truck-specs {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .truck-specs h3 {
            margin-bottom: 15px;
            text-align: center;
        }

        .specs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .spec-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .spec-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .spec-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .risk-matrix {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .report-meta {
                flex-direction: column;
                gap: 10px;
            }
        }

        .summary-box {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .summary-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> Detailed Route Analysis Report</h1>
            <div class="subtitle">Heavy Vehicle Navigation - Comprehensive Safety & Performance Analysis</div>
            <div class="report-meta">
                <div><i class="fas fa-calendar"></i> Generated: {{ moment().format('MMMM DD, YYYY') }}</div>
                <div><i class="fas fa-truck"></i> Vehicle: {{ report.truck_weight }}T Heavy Truck</div>
                <div><i class="fas fa-tachometer-alt"></i> Max Speed: {{ report.max_speed_limit }} km/h</div>
            </div>
        </div>

        <div class="content">
            <!-- Executive Summary -->
            <div class="summary-box">
                <div class="summary-title">ðŸ“‹ Executive Summary</div>
                <p>This route analysis covers {{ report.total_distance }} with an estimated duration of {{ report.total_duration }}. 
                The route has been analyzed for a {{ report.truck_weight }}-tonne heavy vehicle with comprehensive safety assessments 
                including {{ report.route_analysis.high_risk_zones }} high-risk zones and {{ report.route_analysis.medium_risk_zones }} medium-risk areas.</p>
            </div>

            <!-- Vehicle Specifications -->
            <div class="truck-specs">
                <h3><i class="fas fa-truck"></i> Vehicle Specifications & Constraints</h3>
                <div class="specs-grid">
                    <div class="spec-item">
                        <div class="spec-value">{{ report.truck_weight }}T</div>
                        <div class="spec-label">Maximum Load Weight</div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-value">{{ report.max_speed_limit }}</div>
                        <div class="spec-label">Speed Limit (km/h)</div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-value">{{ "%.1f"|format(report.route_analysis.points_per_km) }}</div>
                        <div class="spec-label">Analysis Points/km</div>
                    </div>
                    <div class="spec-item">
                        <div class="spec-value">{{ report.route_analysis.total_points }}</div>
                        <div class="spec-label">Total Route Points</div>
                    </div>
                </div>
            </div>

            <!-- Route Overview -->
            <div class="section">
                <h2><i class="fas fa-route"></i> Route Overview</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">{{ report.total_distance }}</div>
                        <div class="stat-label">Total Distance</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">{{ report.total_duration }}</div>
                        <div class="stat-label">Estimated Duration</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">{{ report.route_analysis.hospitals_along_route + report.route_analysis.fuel_stations + report.route_analysis.police_stations }}</div>
                        <div class="stat-label">Total POIs</div>
                    </div>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="section">
                <h2><i class="fas fa-exclamation-triangle"></i> Risk Assessment Matrix</h2>
                
                {% if report.route_analysis.high_risk_zones > 0 %}
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>Critical Alert:</strong> This route contains {{ report.route_analysis.high_risk_zones }} high-risk zones requiring immediate attention and reduced speeds.
                </div>
                {% endif %}

                <div class="risk-matrix">
                    <div class="risk-card risk-high">
                        <h3 style="color: #e74c3c; margin-bottom: 10px;">High Risk</h3>
                        <div class="stat-value" style="color: #e74c3c;">{{ report.route_analysis.high_risk_zones }}</div>
                        <p style="font-size: 0.9em; margin-top: 10px;">Zones requiring extreme caution, speed reduction to 15-25 km/h</p>
                    </div>
                    <div class="risk-card risk-medium">
                        <h3 style="color: #f39c12; margin-bottom: 10px;">Medium Risk</h3>
                        <div class="stat-value" style="color: #f39c12;">{{ report.route_analysis.medium_risk_zones }}</div>
                        <p style="font-size: 0.9em; margin-top: 10px;">Areas requiring increased awareness, speed limit 30-40 km/h</p>
                    </div>
                    <div class="risk-card risk-low">
                        <h3 style="color: #27ae60; margin-bottom: 10px;">Safe Zones</h3>
                        <div class="stat-value" style="color: #27ae60;">{{ (report.route_analysis.total_points - report.route_analysis.high_risk_zones - report.route_analysis.medium_risk_zones) }}</div>
                        <p style="font-size: 0.9em; margin-top: 10px;">Normal driving conditions, maintain speed limit</p>
                    </div>
                </div>
            </div>

            <!-- Traffic Analysis -->
            <div class="section">
                <h2><i class="fas fa-traffic-light"></i> Traffic Analysis</h2>
                
                <div class="progress-section">
                    <div class="progress-item">
                        <div class="progress-label">
                            <span><i class="fas fa-circle" style="color: #27ae60;"></i> Light Traffic Segments</span>
                            <span>{{ report.traffic_analysis.light_traffic_segments }} segments</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill progress-success" 
                                 style="width: {{ (report.traffic_analysis.light_traffic_segments / (report.traffic_analysis.light_traffic_segments + report.traffic_analysis.moderate_traffic_segments + report.traffic_analysis.heavy_traffic_segments) * 100)|int }}%;"></div>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <div class="progress-label">
                            <span><i class="fas fa-circle" style="color: #f39c12;"></i> Moderate Traffic Segments</span>
                            <span>{{ report.traffic_analysis.moderate_traffic_segments }} segments</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill progress-warning" 
                                 style="width: {{ (report.traffic_analysis.moderate_traffic_segments / (report.traffic_analysis.light_traffic_segments + report.traffic_analysis.moderate_traffic_segments + report.traffic_analysis.heavy_traffic_segments) * 100)|int }}%;"></div>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <div class="progress-label">
                            <span><i class="fas fa-circle" style="color: #e74c3c;"></i> Heavy Traffic Segments</span>
                            <span>{{ report.traffic_analysis.heavy_traffic_segments }} segments</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill progress-danger" 
                                 style="width: {{ (report.traffic_analysis.heavy_traffic_segments / (report.traffic_analysis.light_traffic_segments + report.traffic_analysis.moderate_traffic_segments + report.traffic_analysis.heavy_traffic_segments) * 100)|int }}%;"></div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Average Delay Factor:</strong> {{ "%.2f"|format(report.traffic_analysis.average_delay_factor) }}x - 
                    This means the journey may take {{ "%.0f"|format((report.traffic_analysis.average_delay_factor - 1) * 100) }}% longer than normal due to traffic conditions.
                </div>
            </div>

            <!-- Infrastructure Analysis -->
            <div class="section">
                <h2><i class="fas fa-map-marked-alt"></i> Infrastructure & Emergency Services</h2>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>Service Type</th>
                            <th>Count Along Route</th>
                            <th>Availability</th>
                            <th>Emergency Access</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><i class="fas fa-hospital" style="color: #e74c3c;"></i> Hospitals</td>
                            <td>{{ report.route_analysis.hospitals_along_route }}</td>
                            <td>
                                {% if report.route_analysis.hospitals_along_route >= 3 %}
                                <span style="color: #27ae60;">Excellent</span>
                                {% elif report.route_analysis.hospitals_along_route >= 1 %}
                                <span style="color: #f39c12;">Good</span>
                                {% else %}
                                <span style="color: #e74c3c;">Limited</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if report.route_analysis.hospitals_along_route >= 1 %}
                                <i class="fas fa-check-circle" style="color: #27ae60;"></i> Available
                                {% else %}
                                <i class="fas fa-times-circle" style="color: #e74c3c;"></i> Not Available
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-shield-alt" style="color: #3498db;"></i> Police Stations</td>
                            <td>{{ report.route_analysis.police_stations }}</td>
                            <td>
                                {% if report.route_analysis.police_stations >= 3 %}
                                <span style="color: #27ae60;">Excellent</span>
                                {% elif report.route_analysis.police_stations >= 1 %}
                                <span style="color: #f39c12;">Good</span>
                                {% else %}
                                <span style="color: #e74c3c;">Limited</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if report.route_analysis.police_stations >= 1 %}
                                <i class="fas fa-check-circle" style="color: #27ae60;"></i> Available
                                {% else %}
                                <i class="fas fa-times-circle" style="color: #e74c3c;"></i> Not Available
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td><i class="fas fa-gas-pump" style="color: #f39c12;"></i> Fuel Stations</td>
                            <td>{{ report.route_analysis.fuel_stations }}</td>
                            <td>
                                {% if report.route_analysis.fuel_stations >= 3 %}
                                <span style="color: #27ae60;">Excellent</span>
                                {% elif report.route_analysis.fuel_stations >= 1 %}
                                <span style="color: #f39c12;">Good</span>
                                {% else %}
                                <span style="color: #e74c3c;">Limited</span>
                                {% endif %}
                            </td>
                            <td>
                                {% if report.route_analysis.fuel_stations >= 1 %}
                                <i class="fas fa-check-circle" style="color: #27ae60;"></i> Available
                                {% else %}
                                <i class="fas fa-times-circle" style="color: #e74c3c;"></i> Plan Refueling
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Safety Recommendations -->
            <div class="section">
                <h2><i class="fas fa-shield-alt"></i> Comprehensive Safety Recommendations</h2>
                
                <ul class="recommendations-list">
                    {% for recommendation in report.safety_recommendations %}
                    <li>{{ recommendation }}</li>
                    {% endfor %}
                </ul>

                <!-- Additional Safety Protocols -->
                <div style="margin-top: 25px;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px;"><i class="fas fa-clipboard-check"></i> Additional Safety Protocols</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" style="color: #e74c3c;">15-25</div>
                            <div class="stat-label">km/h in High Risk Zones</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: #f39c12;">30-40</div>
                            <div class="stat-label">km/h in Medium Risk Zones</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: #27ae60;">{{ report.max_speed_limit }}</div>
                            <div class="stat-label">km/h Maximum Speed</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Accident Probability Analysis -->
            <div class="section">
                <h2><i class="fas fa-exclamation-triangle"></i> Accident Probability & Risk Factors</h2>
                
                <div class="alert alert-warning">
                    <i class="fas fa-chart-line"></i>
                    <strong>Risk Assessment:</strong> Based on route analysis, sharp turns, traffic density, and infrastructure proximity.
                </div>

                <div class="chart-placeholder">
                    <div style="text-align: center;">
                        <i class="fas fa-chart-pie" style="font-size: 3em; color: #bdc3c7; margin-bottom: 15px;"></i>
                        <h3 style="color: #7f8c8d;">Risk Distribution Chart</h3>
                        <p style="color: #95a5a6;">
                            High Risk: {{ "%.1f"|format((report.route_analysis.high_risk_zones / report.route_analysis.total_points * 100)) }}% | 
                            Medium Risk: {{ "%.1f"|format((report.route_analysis.medium_risk_zones / report.route_analysis.total_points * 100)) }}% | 
                            Safe: {{ "%.1f"|format(((report.route_analysis.total_points - report.route_analysis.high_risk_zones - report.route_analysis.medium_risk_zones) / report.route_analysis.total_points * 100)) }}%
                        </p>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" style="color: #e74c3c;">
                            {% if report.route_analysis.high_risk_zones > 5 %}HIGH
                            {% elif report.route_analysis.high_risk_zones > 2 %}MEDIUM
                            {% else %}LOW{% endif %}
                        </div>
                        <div class="stat-label">Overall Risk Level</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #3498db;">{{ "%.1f"|format((report.route_analysis.high_risk_zones + report.route_analysis.medium_risk_zones) / report.route_analysis.total_points * 100) }}%</div>
                        <div class="stat-label">Route Risk Coverage</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #27ae60;">{{ "%.1f"|format(((report.route_analysis.total_points - report.route_analysis.high_risk_zones - report.route_analysis.medium_risk_zones) / report.route_analysis.total_points * 100)) }}%</div>
                        <div class="stat-label">Safe Zone Coverage</div>
                    </div>
                </div>
            </div>

            <!-- Environmental & Weather Considerations -->
            <div class="section">
                <h2><i class="fas fa-cloud-sun"></i> Environmental Factors</h2>
                
                <div class="alert alert-info">
                    <i class="fas fa-thermometer-half"></i>
                    <strong>Note:</strong> Weather conditions can significantly impact heavy vehicle safety. Monitor weather forecasts before departure.
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" style="color: #3498db;">
                            <i class="fas fa-eye"></i>
                        </div>
                        <div class="stat-label">Visibility Monitoring Required</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #f39c12;">
                            <i class="fas fa-wind"></i>
                        </div>
                        <div class="stat-label">Wind Speed Awareness</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #e74c3c;">
                            <i class="fas fa-snowflake"></i>
                        </div>
                        <div class="stat-label">Weather Condition Checks</div>
                    </div>
                </div>
            </div>

            <!-- Action Items & Next Steps -->
            <div class="section">
                <h2><i class="fas fa-tasks"></i> Action Items & Recommendations</h2>
                
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    <strong>Pre-Journey Checklist:</strong> Complete all safety checks before departure.
                </div>

                <ul class="recommendations-list">
                    <li><strong>Pre-departure:</strong> Conduct thorough vehicle inspection focusing on brakes, tires, and load security</li>
                    <li><strong>Route Planning:</strong> Share route details with dispatch and emergency contacts</li>
                    <li><strong>Communication:</strong> Maintain regular check-ins every 2 hours during journey</li>
                    <li><strong>Emergency Kit:</strong> Ensure first aid kit, emergency triangles, and communication devices are available</li>
                    <li><strong>Rest Stops:</strong> Plan mandatory rest breaks every 4 hours for driver safety</li>
                    <li><strong>Weather Monitoring:</strong> Check weather conditions before departure and during journey</li>
                </ul>
            </div>

            <!-- Footer Actions -->
            <div class="action-buttons">
                <a href="javascript:window.print()" class="btn btn-primary">
                    <i class="fas fa-print"></i> Print Report
                </a>
                <a href="{{ url_for('home') }}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Route Planning
                </a>
                <a href="#" onclick="downloadReport()" class="btn btn-success">
                    <i class="fas fa-download"></i> Download PDF
                </a>
                <a href="mailto:?subject=Route Analysis Report&body=Please find the attached route analysis report for heavy vehicle navigation." class="btn btn-danger">
                    <i class="fas fa-envelope"></i> Share Report
                </a>
            </div>
        </div>
    </div>

    <script>
        // Print optimization
        window.addEventListener('beforeprint', function() {
            document.body.style.background = 'white';
        });

        window.addEventListener('afterprint', function() {
            document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        });

        // Download report function
        function downloadReport() {
            // In a real implementation, this would generate a PDF
            alert('PDF download feature would be implemented here. Currently showing report data.');
            console.log('Report data for PDF generation:', {
                totalDistance: '{{ report.total_distance }}',
                totalDuration: '{{ report.total_duration }}',
                truckWeight: '{{ report.truck_weight }}',
                highRiskZones: '{{ report.route_analysis.high_risk_zones }}',
                mediumRiskZones: '{{ report.route_analysis.medium_risk_zones }}'
            });
        }

        // Auto-scroll to sections
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }

        // Add current date/time
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const reportMeta = document.querySelector('.report-meta');
            if (reportMeta) {
                const dateElement = reportMeta.querySelector('div:first-child');
                if (dateElement) {
                    dateElement.innerHTML = `<i class="fas fa-calendar"></i> Generated: ${now.toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    })}`;
                }
            }
        });

        // Highlight critical sections
        document.addEventListener('DOMContentLoaded', function() {
            const highRiskZones = {{ report.route_analysis.high_risk_zones }};
            if (highRiskZones > 3) {
                const alerts = document.querySelectorAll('.alert-danger');
                alerts.forEach(alert => {
                    alert.style.animation = 'pulse 2s infinite';
                });
            }
        });
    </script>
</body>
</html>
